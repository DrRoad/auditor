---
title: "Half-normal plots"
author: "Alicja Gosiewska"
date: "2 stycznia 2018"
output: html_document
---


```{r setup, echo = FALSE}
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

```{r}
library(auditor)
```


# Half-normal plot

```{r}
data("corn", package = "hnp")
head(corn)
```


```{r}
model <- glm(cbind(y, m - y) ~ extract, family = binomial, data = corn)

set.seed(1234)
plotHalfNormal(model)
```


# Normal plot

```{r}
plotHalfNormal(model, halfnormal = FALSE)
```


# Implementing new model classes

Negative binomial type-I model using package gamlss
```{r}
library("gamlss")
data("orange", package = "hnp")

modelNBII <- gamlss(embryos ~ block + poly(dose, 2) * sugar,
  family = NBII(), data = orange, trace=FALSE)

dFun <- function(obj) resid(obj)
sFun <- function(n, obj) rNBII(n, obj$mu.fv, obj$sigma.fv)
fFun <- function(y.) gamlss(y. ~ block + poly(dose, 2) * sugar, 
                             family = NBII(), data = orange, trace=FALSE)

plotHalfNormal(modelNBII,
               newclass = TRUE,
               diagfun = dFun, simfun = sFun, fitfun = fFun,
               xlab = "Half-normal scores", ylab = "z-scores")

```








