---
title: "Half-normal plots"
author: "Alicja Gosiewska"
date: "2 stycznia 2018"
output: html_document
---


```{r setup, echo = FALSE}
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

```{r}
library(auditor)
```


# Half-normal plot

```{r}
data("corn", package = "hnp")
head(corn)
```


```{r}
model <- glm(cbind(y, m - y) ~ extract, family = binomial, data = corn)

set.seed(1234)
plotHalfNormal(model)
```


# Normal plot

```{r}
plotHalfNormal(model, halfnormal = FALSE)
```


# Implementing new model classes

Negative binomial type-I model using package gamlss
```{r}
library("gamlss")
data("orange", package = "hnp")

model_NBII <- gamlss(embryos ~ block + poly(dose, 2) * sugar,
  family = NBII(), data = orange, trace=FALSE)

d.fun <- function(obj) resid(obj)
s.fun <- function(n, obj) rNBII(n, obj$mu.fv, obj$sigma.fv)
f.fun <- function(y.) gamlss(y. ~ block + poly(dose, 2) * sugar, 
                             family = NBII(), data = orange, trace=FALSE)

plotHalfNormal(model_NBII, newclass = TRUE, diagfun = d.fun, simfun = s.fun,
  fitfun = f.fun, xlab = "Half-normal scores", ylab = "z-scores", sim = 20)

```








